function me(){return!(typeof process>"u"||!process.cwd||!process.versions||typeof process.versions.node>"u"||!process.release||process.release.name!=="node")}function z(e,t){let n;{var r=Error.stackTraceLimit;Error.stackTraceLimit=1/0,n=new Error(e),Error.stackTraceLimit=r}return me()&&(n.stack=ye(n.stack,t)),n}function ye(e,t){if(!e)return e;const n=Ee(e);let r=0;return n.filter(o=>o.includes(" (internal/")||o.includes(" (node:internal")?!1:r<t&&ve(o)?(r++,!1):!0).join(`
`)}function ve(e){return e.startsWith("    at ")}function Ee(e){return e.split(/\r?\n/)}function P(e,t){const n=globalThis.__vite_plugin_ssr=globalThis.__vite_plugin_ssr||{};return n[e]=n[e]||t}function b(e){return typeof e=="object"&&e!==null}function V(e){return Array.from(new Set(e))}const w=P("assertPackageInstances.ts",{instances:[],alreadyLogged:new Set}),re="Make sure your client-side code doesn't include(/bundle)",se=`The client runtime of Server Routing and the client runtime of Client Routing are both being loaded. ${re} both for a given page.`,B=`Two vite-plugin-ssr client runtime instances are being loaded. ${re} vite-plugin-ssr twice. (In order to reduce the size of your client-side JavaScript bundles.)`;function U(){{const e=V(w.instances);if(e.length>1){const t=`Both vite-plugin-ssr@${e[0]} and vite-plugin-ssr@${e[1]} loaded. Only one version should be loaded.`;be(!1,t)}}w.checkSingleInstance&&w.instances.length>1&&L(!1,B,{onlyOnce:!0,showStackTrace:!0})}function xt(e){L(w.isClientRouting!==!0,se,{onlyOnce:!0,showStackTrace:!0}),L(w.isClientRouting===void 0,B,{onlyOnce:!0,showStackTrace:!0}),w.isClientRouting=!1,e&&(w.checkSingleInstance=!0),U()}function Ct(e){L(w.isClientRouting!==!1,se,{onlyOnce:!0,showStackTrace:!0}),L(w.isClientRouting===void 0,B,{onlyOnce:!0,showStackTrace:!0}),w.isClientRouting=!0,e&&(w.checkSingleInstance=!0),U()}function we(e){w.instances.push(e),U()}function be(e,t){if(e)return;const n=`[vite-plugin-ssr][Wrong Usage] ${t}`;throw new Error(n)}function L(e,t,{onlyOnce:n,showStackTrace:r}){if(e)return;const s=`[vite-plugin-ssr][Warning] ${t}`;if(n){const{alreadyLogged:o}=w,a=n===!0?s:n;if(o.has(a))return;o.add(a)}console.warn(r?new Error(s):s)}const _e="0.4.133",S={projectName:"vite-plugin-ssr",projectVersion:_e,npmPackageName:"vite-plugin-ssr",githubRepository:"https://github.com/brillout/vite-plugin-ssr"};we(S.projectVersion);const v=P("utils/assert.ts",{alreadyLogged:new Set,logger(e,t){t==="info"?console.log(e):console.warn(e)},colorer:e=>e,showStackTraceList:new WeakSet}),Re=`[${S.npmPackageName}]`,Se=`[${S.npmPackageName}@${S.projectVersion}]`,H=2;function i(e,t){var n;if(e)return;const r=(()=>{if(!t)return null;const a=typeof t=="string"?t:"`"+JSON.stringify(t)+"`";return`Debug info (this is for the ${S.projectName} maintainers; you can ignore this): ${a}`})();let s=[`You stumbled upon a bug in ${S.projectName}'s source code.`,`Go to ${S.githubRepository}/issues/new and copy-paste this error; a maintainer will fix the bug (usually under 24 hours).`,r].filter(Boolean).join(" ");s=I(s,"Bug"),s=j(s,!0);const o=z(s,H);throw(n=v.onBeforeLog)===null||n===void 0||n.call(v),o}function y(e,t,{showStackTrace:n}={}){var r;if(e)return;t=I(t,"Wrong Usage"),t=j(t);const s=z(t,H);throw n&&v.showStackTraceList.add(s),(r=v.onBeforeLog)===null||r===void 0||r.call(v),s}function $e(e){return e=I(e,"Error"),e=j(e),z(e,H)}function $(e,t,{onlyOnce:n=!0,showStackTrace:r}={}){var s;if(!e){if(t=I(t,"Warning"),t=j(t),n){const{alreadyLogged:o}=v,a=n===!0?t:n;if(o.has(a))return;o.add(a)}if((s=v.onBeforeLog)===null||s===void 0||s.call(v),r){const o=new Error(t);v.showStackTraceList.add(o),v.logger(o,"warn")}else v.logger(t,"warn")}}function Wt(e,t,{onlyOnce:n}){var r;if(!e){if(t=I(t,"Info"),t=j(t),n){const{alreadyLogged:s}=v,o=t;if(s.has(o))return;s.add(o)}(r=v.onBeforeLog)===null||r===void 0||r.call(v),v.logger(t,"info")}}function I(e,t){let n=`[${t}]`;const r=t==="Info"?"blue":t==="Warning"?"yellow":"red";n=v.colorer(n,r);const s=e.startsWith("[")?"":" ";return`${n}${s}${e}`}function j(e,t=!1){return`${t?Se:Re}${e}`}function G(){return typeof window<"u"&&typeof window.scrollY=="number"}const O=P("utils/assertRouterType.ts",{});function At(){ie(Te()),O.isClientRouting=!0}function Te(){return O.isClientRouting!==!1}function Dt(){ie(O.isClientRouting!==!0),O.isClientRouting=!1}function ie(e){y(G(),"`import { something } from 'vite-plugin-ssr/client/router'` is forbidden on the server-side",{showStackTrace:!0}),$(e,"You shouldn't `import { something } from 'vite-plugin-ssr/client/router'` when using Server Routing. The 'vite-plugin-ssr/client/router' utilities work only with Client Routing. In particular, don't `import { navigate }` nor `import { prefetch }` as they unnecessarily bloat your client-side bundle.",{showStackTrace:!0,onlyOnce:!0})}const Pe=["js","ts","cjs","cts","mjs","mts","jsx","tsx","cjsx","ctsx","mjsx","mtsx"],oe=["vue","svelte","marko","md","mdx"],Le=[...Pe,...oe];function ae(e){const t=Le.some(n=>e.endsWith("."+n));return i(!Ie(e)||t),t}function Ie(e){return/\.(c|m)?(j|t)sx?$/.test(e)}function je(e){return oe.some(t=>e.endsWith("."+t))}function k(e,t,n){return typeof e=="string"?q(e.split(""),t,n).join(""):q(e,t,n)}function q(e,t,n){const r=[];let s=t>=0?t:e.length+t;i(s>=0&&s<=e.length);let o=n>=0?n:e.length+n;for(i(o>=0&&o<=e.length);!(s===o||(s===e.length&&(s=0),s===o));){const a=e[s];i(a!==void 0),r.push(a),s++}return r}function le(e){return e.startsWith("/")||e.startsWith("http")||e.startsWith("tauri://")||e.startsWith(".")||e.startsWith("?")||e.startsWith("#")||e===""}function Nt(e,t){i(t.includes(" but ")),y(typeof e=="string",`${t} should be a string`),!le(e)&&(!e.startsWith("/")&&!e.includes(":")?y(!1,`${t} is '${e}' and it should be '/${e}' instead (URL pathnames should start with a leading slash)`):y(!1,`${t} isn't a valid URL`))}function Fe(e,t){i(le(e),{url:e}),i(t.startsWith("/"),{url:e,baseServer:t});const[n,...r]=e.split("#");i(n!==void 0);const s=["",...r].join("#")||null;i(s===null||s.startsWith("#"));const o=s===null?"":A(s.slice(1)),[a,...l]=n.split("?");i(a!==void 0);const u=["",...l].join("?")||null;i(u===null||u.startsWith("?"),{url:e,searchOriginal:u});const c={},g={};Array.from(new URLSearchParams(u||"")).forEach(([E,Y])=>{c[E]=Y,g[E]=[...g[E]||[],Y]});const{origin:f,pathnameResolved:p}=ke(a,t);i(f===null||f===A(f),{origin:f}),i(p.startsWith("/"),{url:e,pathnameResolved:p}),i(f===null||e.startsWith(f),{url:e,origin:f});const h=a.slice((f||"").length);{const E=`${f||""}${h}${u||""}${s||""}`;i(e===E,{url:e,urlRecreated:E})}let{pathname:m,hasBaseServer:_}=Ce(p,t);return m=Oe(m),i(m.startsWith("/")),{origin:f,pathname:m,pathnameOriginal:h,hasBaseServer:_,search:c,searchAll:g,searchOriginal:u,hash:o,hashOriginal:s}}function A(e){try{return decodeURIComponent(e)}catch{}try{return decodeURI(e)}catch{}return e}function Oe(e){return e.split("/").map(t=>A(t).split("/").join("%2F")).join("/")}function ke(e,t){var n;if(e.startsWith("//"))return{origin:null,pathnameResolved:e};let r=!1;const s="tauri://",o="http://";e.startsWith(s)&&(r=!0,e=o+e.slice(s.length));let a,l;try{const u=new URL(e);a=u.origin,l=u.pathname}catch{a=null;let c=typeof window<"u"&&((n=window==null?void 0:window.document)===null||n===void 0?void 0:n.baseURI);c=c||"http://fake.example.org"+t,l=new URL(e,c).pathname}return l||(l="/"),r&&(i(a),i(a.startsWith(o)),a=s+a.slice(o.length)),i(l.startsWith("/"),{urlWithoutSearch:e,pathnameResolved:l}),i(l===l.split("?")[0].split("#")[0]),{origin:a,pathnameResolved:l}}function xe(e){i(e.startsWith("/")),i(!e.includes("?")),i(!e.includes("#"))}function Ce(e,t){xe(e),i(We(t));let n=e;if(i(n.startsWith("/")),i(t.startsWith("/")),t==="/")return{pathname:e,hasBaseServer:!0};let r=t;return t.endsWith("/")&&n===k(t,0,-1)&&(r=k(t,0,-1),i(n===r)),n.startsWith(r)?(i(n.startsWith("/")||n.startsWith("http")),i(n.startsWith(r)),n=n.slice(r.length),n.startsWith("/")||(n="/"+n),i(n.startsWith("/")),{pathname:n,hasBaseServer:!0}):{pathname:e,hasBaseServer:!1}}function We(e){return e.startsWith("/")}function M(e,t){Object.assign(e,t)}function x(e){return e instanceof Function||typeof e=="function"}function zt(e){return(t,n)=>{const r=e(t),s=e(n);return r===s?0:r>s?-1:1}}function Ae(e){return(t,n)=>{const r=e(t),s=e(n);if(i([!0,!1,null].includes(r)),i([!0,!1,null].includes(s)),r===s)return 0;if(r===!0||s===!1)return-1;if(s===!0||r===!1)return 1;i(!1)}}function De(e){return Ae(t=>{const n=e(t);return n===null?null:!n})}function d(e,t,n="unknown"){if(!b(e))return!1;if(!(t in e))return n==="undefined";if(n==="unknown")return!0;const r=e[t];return n==="array"?Array.isArray(r):n==="object"?b(r):n==="string[]"?Array.isArray(r)&&r.every(s=>typeof s=="string"):n==="function"?x(r):Array.isArray(n)?typeof r=="string"&&n.includes(r):n==="null"?r===null:n==="undefined"?r===void 0:n==="true"?r===!0:n==="false"?r===!1:typeof r===n}function Ne(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0}const ze=e=>e!=null,Ve="\\";function ce(e){const t=n=>`Not a posix path: ${n}`;i(e!==null,t("null")),i(typeof e=="string",t(`typeof path === '${typeof e}'`)),i(e!=="",t("(empty string)")),i(e),i(!e.includes(Ve),t(e))}const Be=["$$registrations","_rerender_only"],Ue=[".md",".mdx"];function He(e,t){Ge(e,t,!0)}function Ge(e,t,n){const s=Object.keys(e).filter(l=>!Be.includes(l)),o=s.filter(l=>l!=="default"),a=s.includes("default");if(o.length===0){if(a)return;i(s.length===0),y(!1,`${t} doesn't export any value, but it should have a \`export default\` instead`)}else if(!Ue.some(l=>t.endsWith(l))){const l=o.join(", ");n?$(o.length===0,`${t} should only have a default export: remove \`export { ${l} }\``,{onlyOnce:!0}):$(o.length===0,`${t} replace \`export { ${l} }\` with \`export default { ${l} }\``,{onlyOnce:!0})}}function Me(e){return Object.entries(e)}const Je=["clientRouting"];function Ye(e){Je.forEach(t=>{if(i(e.fileExports),!(t in e.fileExports))return;const n=`The value of \`${t}\` is only allowed to be \`true\`.`;y(e.fileExports[t]!==!1,`${e.filePath} has \`export { ${t} }\` with the value \`false\` which is prohibited: remove \`export { ${t} }\` instead. (${n})`),y(e.fileExports[t]===!0,`${e.filePath} has \`export { ${t} }\` with a forbidden value. ${n}`)})}const ue=["render","clientRouting","prerender","doNotPrerender"];function qe(e,t){y(!ue.includes(e),`${t} has \`export default { ${e} }\` which is prohibited, use \`export { ${e} }\` instead.`)}function Ke(e,t){const n={},r={},s={};if(e.forEach(l=>{Xe(l).forEach(({exportName:c,exportValue:g,isFromDefaultExport:f})=>{var p;i(c!=="default"),s[c]=(p=s[c])!==null&&p!==void 0?p:[],s[c].push({exportValue:g,exportSource:`${l.filePath} > ${f?`\`export default { ${c} }\``:`\`export { ${c} }\``}`,filePath:l.filePath,_filePath:l.filePath,_fileType:l.fileType,_isFromDefaultExport:f})})}),t){const{configValues:l}=t;Me(l).forEach(([u,c])=>{var g,f,p;const h=t.configElements[u];i(h);const{configDefinedByFile:m,configDefinedAt:_}=h;i(m),r[u]=(g=r[u])!==null&&g!==void 0?g:c,n[u]=(f=n[u])!==null&&f!==void 0?f:[],i(n[u].length===0),n[u].push({configValue:c,configDefinedAt:_,configDefinedByFile:m});const E=u;s[E]=(p=s[E])!==null&&p!==void 0?p:[],s[E].push({exportValue:c,exportSource:_,filePath:m,_filePath:m,_fileType:null,_isFromDefaultExport:null})})}const o=Qe(),a={};return Object.entries(s).forEach(([l,u])=>{u.forEach(({exportValue:c,_fileType:g,_isFromDefaultExport:f})=>{var p;a[l]=(p=a[l])!==null&&p!==void 0?p:c,g===".page"&&!f&&(l in o||(o[l]=c))})}),i(!("default"in a)),i(!("default"in s)),{config:r,configEntries:n,exports:a,exportsAll:s,pageExports:o}}function Xe(e){const{filePath:t,fileExports:n}=e;i(n),i(ae(t));const r=[];return Object.entries(n).sort(De(([s])=>s==="default")).forEach(([s,o])=>{let a=s==="default";if(a)if(je(t))s="Page";else{y(b(o),`The \`export default\` of ${t} should be an object.`),Object.entries(o).forEach(([l,u])=>{qe(l,t),r.push({exportName:l,exportValue:u,isFromDefaultExport:a})});return}r.push({exportName:s,exportValue:o,isFromDefaultExport:a})}),r.forEach(({exportName:s,isFromDefaultExport:o})=>{i(!(o&&ue.includes(s)))}),r}function Qe(){return new Proxy({},{get(...e){return G()||$(!1,"`pageContext.pageExports` is outdated. Use `pageContext.exports` instead, see https://vite-plugin-ssr.com/exports",{onlyOnce:!0,showStackTrace:!0}),Reflect.get(...e)}})}function Ze(e){const t=".page.",n=k(e.split(t),0,-1).join(t);return i(!n.includes("\\")),n}function T(e){ce(e)}function Vt(e,t){if(t.length>0){const r=t.filter(s=>s.isErrorPage);return r.length===0?null:(y(r.length===1,"Only one error page can be defined"),r[0].pageId)}const n=V(e.map(({pageId:r})=>r).filter(r=>C(r)));if(y(n.length<=1,`Only one _error.page.js is allowed, but found several: ${n.join(" ")}`),n.length>0){const r=n[0];return i(r),r}return null}function C(e,t){return i(!e.includes("\\")),e.includes("/_error")}function et(e,t){if(t.length>0){const n=t.find(r=>r.pageId===e);return i(n),n.isErrorPage}else return C(e)}const tt=[".page",".page.server",".page.route",".page.client",".css"];function nt(e){if(ce(e),e.endsWith(".css"))return".css";i(ae(e),e);const n=e.split("/").slice(-1)[0].split("."),r=n.slice(-3)[0],s=n.slice(-2)[0];if(s==="page")return".page";if(i(r==="page",e),s==="server")return".page.server";if(s==="client")return".page.client";if(s==="route")return".page.route";i(!1,e)}function fe(e){const t=o=>s.pageId===o||s.isDefaultPageFile&&(K(s.filePath)||rt(o,s.filePath)),n=nt(e),s={filePath:e,fileType:n,isEnv:o=>{if(i(n!==".page.route"),o==="CLIENT_ONLY")return n===".page.client"||n===".css";if(o==="SERVER_ONLY")return n===".page.server";if(o==="CLIENT_AND_SERVER")return n===".page";i(!1)},isRelevant:t,isDefaultPageFile:D(e),isRendererPageFile:n!==".css"&&D(e)&&K(e),isErrorPageFile:C(e),pageId:Ze(e)};return s}function D(e){return T(e),C(e)?!1:e.includes("/_default")}function K(e){return T(e),e.includes("/renderer/")}function rt(e,t){T(e),T(t),i(!e.endsWith("/")),i(!t.endsWith("/")),i(D(t));const n=k(t.split("/"),0,-1).filter(r=>r!=="_default").join("/");return e.startsWith(n)}function st(e){i(Array.isArray(e)||e===null),i(e!==null),e.forEach(t=>{i(b(t)),i(d(t,"pageId","string")),i(d(t,"routeFilesystem","string")||d(t,"routeFilesystem","null")),i(d(t,"routeFilesystemDefinedBy","string")||d(t,"routeFilesystemDefinedBy","null")),i(d(t,"loadCodeFiles","function")),i(d(t,"isErrorPage","boolean")),i(d(t,"configElements","object")),de(t.configElements,!1)})}function it(e){de(e,!0)}function de(e,t){i(b(e)),Object.entries(e).forEach(([n,r])=>{if(i(b(r)||r===null),r===null){i(t);return}i(d(r,"configDefinedAt","string")),i(d(r,"plusConfigFilePath","string")||d(r,"plusConfigFilePath","null")),i(d(r,"configEnv","string")),i(d(r,"codeFilePath","string")||d(r,"codeFilePath","null")),i(d(r,"codeFileExport","string")||d(r,"codeFileExport","null")),i(d(r,"configValueSerialized","string")||d(r,"configValueSerialized","undefined")),(t||n==="route")&&i(d(r,"configValue")||d(r,"configValueSerialized"))})}const ot=[{is:e=>e===void 0,match:e=>e==="!undefined",serialize:()=>"!undefined",deserialize:()=>{}},{is:e=>e===1/0,match:e=>e==="!Infinity",serialize:()=>"!Infinity",deserialize:()=>1/0},{is:e=>e===-1/0,match:e=>e==="!-Infinity",serialize:()=>"!-Infinity",deserialize:()=>-1/0},{is:e=>typeof e=="number"&&isNaN(e),match:e=>e==="!NaN",serialize:()=>"!NaN",deserialize:()=>NaN},{is:e=>e instanceof Date,match:e=>e.startsWith("!Date:"),serialize:e=>"!Date:"+e.toISOString(),deserialize:e=>new Date(e.slice(6))},{is:e=>typeof e=="bigint",match:e=>e.startsWith("!BigInt:"),serialize:e=>"!BigInt:"+e.toString(),deserialize:e=>{if(typeof BigInt>"u")throw new Error("Your JavaScript environement does not support BigInt. Consider adding a polyfill.");return BigInt(e.slice(8))}},{is:e=>e instanceof RegExp,match:e=>e.startsWith("!RegExp:"),serialize:e=>"!RegExp:"+e.toString(),deserialize:e=>{e=e.slice(8);const t=e.match(/\/(.*)\/(.*)?/),n=t[1],r=t[2];return new RegExp(n,r)}},{is:e=>e instanceof Map,match:e=>e.startsWith("!Map:"),serialize:(e,t)=>"!Map:"+t(Array.from(e.entries())),deserialize:(e,t)=>new Map(t(e.slice(5)))},{is:e=>e instanceof Set,match:e=>e.startsWith("!Set:"),serialize:(e,t)=>"!Set:"+t(Array.from(e.values())),deserialize:(e,t)=>new Set(t(e.slice(5)))},{is:e=>typeof e=="string"&&e.startsWith("!"),match:e=>e.startsWith("!"),serialize:e=>"!"+e,deserialize:e=>e.slice(1)}];function J(e){const t=JSON.parse(e);return ge(t)}function ge(e){return typeof e=="string"?at(e):(typeof e=="object"&&e!==null&&Object.entries(e).forEach(([t,n])=>{e[t]=ge(n)}),e)}function at(e){for(const{match:t,deserialize:n}of ot)if(t(e))return n(e,J);return e}function lt(e){e.forEach(t=>{Object.entries(t.configElements).forEach(([n,r])=>{ct(r),n==="route"&&ut(r)})})}function ct(e){const{configValueSerialized:t}=e;t!==void 0&&(e.configValue=J(t))}function ut(e){i(d(e,"configValue"));const{configValue:t}=e,n=typeof t;y(n==="string"||x(t),`${e.configDefinedAt} has an invalid type '${n}': it should be a string or a function instead, see https://vite-plugin-ssr.com/route`)}function ft(e){i(d(e,"isGeneratedFile")),i(e.isGeneratedFile!==!1,"vite-plugin-ssr was re-installed(/re-built). Restart your app."),i(e.isGeneratedFile===!0,`\`isGeneratedFile === ${e.isGeneratedFile}\``),i(d(e,"pageFilesLazy","object")),i(d(e,"pageFilesEager","object")),i(d(e,"pageFilesExportNamesLazy","object")),i(d(e,"pageFilesExportNamesEager","object")),i(d(e.pageFilesLazy,".page")),i(d(e.pageFilesLazy,".page.client")||d(e.pageFilesLazy,".page.server")),i(d(e,"pageFilesList","string[]")),i(d(e,"pageConfigs")),i(d(e,"pageConfigGlobal"));const{pageConfigs:t,pageConfigGlobal:n}=e;st(t),lt(t),it(n);const r={};F(e.pageFilesLazy).forEach(({filePath:o,pageFile:a,globValue:l})=>{var u;a=r[o]=(u=r[o])!==null&&u!==void 0?u:a;const c=l;X(c),a.loadFile=async()=>{"fileExports"in a||(a.fileExports=await c(),Ye(a))}}),F(e.pageFilesExportNamesLazy).forEach(({filePath:o,pageFile:a,globValue:l})=>{var u;a=r[o]=(u=r[o])!==null&&u!==void 0?u:a;const c=l;X(c),a.loadExportNames=async()=>{if(!("exportNames"in a)){const g=await c();y("exportNames"in g,"You seem to be using Vite 2 but the latest vite-plugin-ssr versions only work with Vite 3"),i(d(g,"exportNames","string[]"),a.filePath),a.exportNames=g.exportNames}}}),F(e.pageFilesEager).forEach(({filePath:o,pageFile:a,globValue:l})=>{var u;a=r[o]=(u=r[o])!==null&&u!==void 0?u:a;const c=l;i(b(c)),a.fileExports=c}),F(e.pageFilesExportNamesEager).forEach(({filePath:o,pageFile:a,globValue:l})=>{var u;a=r[o]=(u=r[o])!==null&&u!==void 0?u:a;const c=l;i(b(c)),i(d(c,"exportNames","string[]"),a.filePath),a.exportNames=c.exportNames}),e.pageFilesList.forEach(o=>{var a;r[o]=(a=r[o])!==null&&a!==void 0?a:fe(o)});const s=Object.values(r);return s.forEach(({filePath:o})=>{i(!o.includes("\\"))}),{pageFiles:s,pageConfigs:t,pageConfigGlobal:n}}function F(e){const t=[];return Object.entries(e).forEach(([n,r])=>{i(tt.includes(n)),i(b(r)),Object.entries(r).forEach(([s,o])=>{const a=fe(s);i(a.fileType===n),t.push({filePath:s,pageFile:a,globValue:o})})}),t}function X(e){i(x(e))}const R=P("setPageFiles.ts",{});function Bt(e){const{pageFiles:t,pageConfigs:n,pageConfigGlobal:r}=ft(e);R.pageFilesAll=t,R.pageConfigs=n,R.pageConfigGlobal=r}async function Ut(e,t){e?(i(!R.pageFilesGetter),i(t===void 0)):(i(R.pageFilesGetter),i(typeof t=="boolean"),(!R.pageFilesAll||!t)&&await R.pageFilesGetter());const{pageFilesAll:n,pageConfigs:r,pageConfigGlobal:s}=R;i(n&&r&&s);const o=dt(n,r);return{pageFilesAll:n,allPageIds:o,pageConfigs:r,pageConfigGlobal:s}}function dt(e,t){const n=e.filter(({isDefaultPageFile:o})=>!o).map(({pageId:o})=>o),r=V(n),s=t.map(o=>o.pageId);return[...r,...s]}function gt(e,t){return he(e,t,!0)}function Ht(e,t){return he(e,t,!1)}function he(e,t,n){const r=n?"CLIENT_ONLY":"SERVER_ONLY",s=e.filter(h=>h.isRelevant(t)&&h.fileType!==".page.route").sort(ht(n,t)),o=h=>{const m=s.filter(E=>E.pageId===t&&E.isEnv(h?"CLIENT_AND_SERVER":r));y(m.length<=1,`Merge the following files into a single file: ${m.map(E=>E.filePath).join(" ")}`);const _=m[0];return i(_===void 0||!_.isDefaultPageFile),_},a=o(!1),l=o(!0),u=h=>s.filter(m=>m.isRendererPageFile&&m.isEnv(h?"CLIENT_AND_SERVER":r))[0],c=u(!1),g=u(!0),f=s.filter(h=>h.isDefaultPageFile&&!h.isRendererPageFile&&(h.isEnv(r)||h.isEnv("CLIENT_AND_SERVER")));return[a,l,...f,c,g].filter(ze)}function ht(e,t){const n=e?"CLIENT_ONLY":"SERVER_ONLY",r=-1,s=1,o=0;return(a,l)=>{if(!a.isDefaultPageFile&&l.isDefaultPageFile)return r;if(!l.isDefaultPageFile&&a.isDefaultPageFile)return s;{const u=a.isRendererPageFile,c=l.isRendererPageFile;if(!u&&c)return r;if(!c&&u)return s;i(u===c)}{const u=Q(t,a.filePath),c=Q(t,l.filePath);if(u<c)return r;if(c<u)return s;i(u===c)}{if(a.isEnv(n)&&l.isEnv("CLIENT_AND_SERVER"))return r;if(l.isEnv(n)&&a.isEnv("CLIENT_AND_SERVER"))return s}return o}}function Q(e,t){T(e),T(t);let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);const r=e.slice(n),s=t.slice(n),o=r.split("/").length,a=s.split("/").length;return o+a}const pt="modulepreload",mt=function(e){return"/"+e},Z={},Gt=function(t,n,r){if(!n||n.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=mt(o),o in Z)return;Z[o]=!0;const a=o.endsWith(".css"),l=a?'[rel="stylesheet"]':"";if(!!r)for(let g=s.length-1;g>=0;g--){const f=s[g];if(f.href===o&&(!a||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${l}`))return;const c=document.createElement("link");if(c.rel=a?"stylesheet":pt,a||(c.as="script",c.crossOrigin=""),c.href=o,document.head.appendChild(c),a)return new Promise((g,f)=>{c.addEventListener("load",g),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t()).catch(o=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o})};function ee(e){const t=e/1e3;if(t<120){const n=te(t);return`${n} second${ne(n)}`}{const n=t/60,r=te(n);return`${r} minute${ne(r)}`}}function te(e){let t=e.toFixed(1);return t.endsWith(".0")&&(t=t.slice(0,-2)),t}function ne(e){return e==="1"?"":"s"}const yt=P("utils/executeHook.ts",{userHookErrors:new Map});function vt(e,t,n){const{timeoutErr:r,timeoutWarn:s}=Et(t);let o,a;const l=new Promise((f,p)=>{o=h=>{u(),f(h)},a=h=>{u(),p(h)}}),u=()=>{clearTimeout(c),clearTimeout(g)},c=setTimeout(()=>{$(!1,`The ${t}() hook defined by ${n} is taking more than ${ee(s)}`)},s),g=setTimeout(()=>{const f=$e(`Hook timeout: the ${t}() hook defined by ${n} didn't finish after ${ee(r)}`);a(f)},r);return(async()=>{try{const f=await e();o(f)}catch(f){b(f)&&yt.userHookErrors.set(f,{hookName:t,hookFilePath:n}),a(f)}})(),l}function Et(e){return e==="onBeforeRoute"?{timeoutErr:5*1e3,timeoutWarn:1*1e3}:e==="onBeforePrerender"?{timeoutErr:10*60*1e3,timeoutWarn:30*1e3}:{timeoutErr:40*1e3,timeoutWarn:4*1e3}}function Mt(e){const t=window.location.href,{searchOriginal:n,hashOriginal:r,pathname:s}=Fe(t,"/");let o;return e!=null&&e.withoutHash?o=`${s}${n||""}`:o=`${s}${n||""}${r||""}`,i(o.startsWith("/")),o}i(G());function Jt(){const e="vite-plugin-ssr_pageContext",t=document.getElementById(e);y(t,`The element #${e} (which vite-plugin-ssr automatically injects into the HTML) is missing from the DOM. This may happen if your HTML is malformed. Make sure your HTML isn't malformed, and make sure you don't remove #${e} from the HTML nor from the DOM.`);const n=t.textContent;i(n);const r=J(n);i(d(r,"pageContext","object"));const{pageContext:s}=r;return i(d(s,"_pageId","string")),M(s,{_pageContextRetrievedFromServer:{...s},_comesDirectlyFromServer:!0}),s}function N(e,t){if(!(t in e.exports))return null;const n=e.exports[t],r=e.exportsAll[t][0];i(r.exportValue===n);const s=r.exportSource;return i(s),i(!t.endsWith(")")),y(x(n),`hook ${t}() defined by ${s} should be a function`),{hookFn:n,hookFilePath:s}}function Yt(e,t){N(e,t)}function wt(e){const t=Object.entries(e);for(const n in e)delete e[n];t.sort(([n],[r])=>Ne(n,r)).forEach(([n,r])=>{e[n]=r})}function bt(e){_t(e),Rt(e)}function _t(e){et(e._pageId,e._pageConfigs)&&i(d(e,"is404","boolean"))}function Rt(e){if(e.is404===void 0||e.is404===null)return;const t=e.pageProps||{};if(!b(t)){$(!1,"pageContext.pageProps should be an object",{showStackTrace:!0,onlyOnce:!0});return}t.is404=t.is404||e.is404,e.pageProps=t}const W=P("preparePageContextForUserConsumptionClientSide.ts",{});function St(e,t){if(t){const s=e;i([!0,!1].includes(s.isHydration)),i([!0,!1,null].includes(s.isBackwardNavigation))}else{const s=e;i(s.isHydration===!0),i(s.isBackwardNavigation===null)}i("config"in e),i("configEntries"in e),i("exports"in e),i("exportsAll"in e),i("pageExports"in e),i(b(e.pageExports));const n=e.exports.Page;M(e,{Page:n}),It(e),wt(e),i([!0,!1].includes(e._comesDirectlyFromServer));const r=e._comesDirectlyFromServer?Pt(e):e;return bt(e),r}const $t=["then","toJSON"],Tt=["_pageId"];function Pt(e){return new Proxy(e,{get:n});function t(r){return!(r in e||$t.includes(r)||typeof r=="symbol"||typeof r!="string"||r.startsWith("__v_"))}function n(r,s){return W.disableAssertPassToClient!==s&&Lt(e._pageContextRetrievedFromServer,s,t(s)),W.disableAssertPassToClient=s,window.setTimeout(()=>{W.disableAssertPassToClient=void 0},0),e[s]}}function Lt(e,t,n){if(!n||e===null)return;const r=Object.keys(e).filter(s=>!Tt.includes(s));y(!1,[`pageContext.${t} isn't available in the browser`,`('${t}' is missing in the passToClient list [${r.map(s=>`'${s}'`).join(", ")}]).`,`Did you forget to add '${t}' to the passToClient list?`,"See https://vite-plugin-ssr.com/passToClient"].join(" "))}function It(e){Object.entries(e).forEach(([t,n])=>{delete e[t],e[t]=n})}function jt(e,t){var n;const r=e.filter(o=>o.pageId===t);return i(r.length<=1),(n=r[0])!==null&&n!==void 0?n:null}async function Ft(e,t){const n={};return!t&&"configValues"in e||((await e.loadCodeFiles()).forEach(s=>{const{configName:o,codeFilePath:a}=s;let l;if(s.isPlusFile){const{codeFileExports:u}=s;o!=="client"&&He(u,a),Object.entries(u).forEach(([c,g])=>{const f=c!=="default",p=f?c:s.configName,h=g;if(n[p]=h,f){const m=e.configElements[s.configName];i(m),e.configElements[p]={configValue:h,codeFileExport:c,codeFilePath:a,configDefinedByFile:a,configDefinedAt:`${a} > export { ${c} }`,configEnv:m.configEnv,plusConfigFilePath:null}}})}else l=s.codeFileExportValue,n[o]=l}),Object.entries(e.configElements).map(([s,o])=>{o.codeFilePath||(n[s]=o.configValue)}),M(e,{configValues:n})),e}const pe="__whileFetchingAssets";async function qt(e,t,n){const r=gt(e,n),s=jt(t,n);let o;try{o=(await Promise.all([s&&Ft(s,!1),...r.map(h=>{var m;return(m=h.loadFile)===null||m===void 0?void 0:m.call(h)})]))[0]}catch(p){throw Ot(p)&&Object.assign(p,{[pe]:!0}),p}const{config:a,configEntries:l,exports:u,exportsAll:c,pageExports:g}=Ke(r,o);return{config:a,configEntries:l,exports:u,exportsAll:c,pageExports:g,_pageFilesLoaded:r}}function Kt(e){return e?e[pe]===!0:!1}function Ot(e){return e instanceof Error?["Failed to fetch dynamically imported module","error loading dynamically imported module","Importing a module script failed","error resolving module specifier","failed to resolve module"].some(n=>e.message.toLowerCase().includes(n.toLowerCase())):!1}async function Xt(e,t){const n=St(e,t);let r=null,s;r=N(e,"render"),s="render";{const l=N(e,"onRenderClient");l&&(r=l,s="onRenderClient")}if(!r){const l=kt(e);if(e._pageConfigs.length>0)y(!1,`No onRenderClient() hook defined for URL '${l}', but it's needed, see https://vite-plugin-ssr.com/onRenderClient`);else{const u=e._pageFilesLoaded.filter(g=>g.fileType===".page.client");let c;u.length===0?c="No file `*.page.client.*` found for URL "+l:c="One of the following files should export a `render()` hook: "+u.map(g=>g.filePath).join(" "),y(!1,c)}}i(r);const o=r.hookFn;i(s);const a=await vt(()=>o(n),s,r.hookFilePath);y(a===void 0,`The ${s}() hook defined by ${r.hookFilePath} isn't allowed to return a value`)}function kt(e){let t;try{t=e.urlOriginal}catch{}return t=t??window.location.href,t}export{$e as A,Ut as B,We as C,gt as D,jt as E,le as F,Wt as G,Te as H,Kt as I,Yt as J,Xt as K,Ct as L,Dt as M,xt as N,Gt as _,b as a,i as b,At as c,G as d,Mt as e,Ht as f,P as g,$ as h,x as i,y as j,zt as k,d as l,Ae as m,Nt as n,M as o,Fe as p,k as q,C as r,Bt as s,N as t,vt as u,Jt as v,qt as w,Vt as x,St as y,J as z};
